{"ast":null,"code":"import { Actions, createEffect, ofType } from '@ngrx/effects';\nimport { of, from } from 'rxjs';\nimport { map, catchError, switchMap, tap } from 'rxjs/operators';\nimport { IndexedDBService } from '../../core/services/indexeddb.service';\nimport * as FormsActions from './forms.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/effects\";\nimport * as i2 from \"../../core/services/indexeddb.service\";\nexport let FormsEffects = /*#__PURE__*/(() => {\n  class FormsEffects {\n    constructor(actions$, db) {\n      this.actions$ = actions$;\n      this.db = db;\n      this.loadForms$ = createEffect(() => this.actions$.pipe(ofType(FormsActions.loadForms), switchMap(() => from(this.db.getAllForms()).pipe(map(forms => FormsActions.loadFormsSuccess({\n        forms\n      })), catchError(error => of(FormsActions.loadFormsFailure({\n        error: error.message\n      })))))));\n      this.saveForm$ = createEffect(() => this.actions$.pipe(ofType(FormsActions.saveForm), switchMap(({\n        form\n      }) => from(this.db.saveForm(form)).pipe(map(() => FormsActions.saveFormSuccess({\n        form\n      })), catchError(error => of(FormsActions.saveFormFailure({\n        error: error.message\n      })))))));\n      this.createForm$ = createEffect(() => this.actions$.pipe(ofType(FormsActions.createForm), switchMap(({\n        form\n      }) => from(this.db.createForm(form)).pipe(map(() => FormsActions.createFormSuccess({\n        form\n      })), catchError(error => of(FormsActions.loadFormsFailure({\n        error: error.message\n      })))))));\n      this.deleteForm$ = createEffect(() => this.actions$.pipe(ofType(FormsActions.deleteForm), switchMap(({\n        id\n      }) => from(this.db.deleteForm(id)).pipe(map(() => FormsActions.deleteFormSuccess({\n        id\n      })), catchError(error => of(FormsActions.loadFormsFailure({\n        error: error.message\n      })))))));\n      this.resetData$ = createEffect(() => this.actions$.pipe(ofType(FormsActions.resetData), switchMap(() => from(fetch('/assets/seed-forms.json')).pipe(switchMap(response => from(response.json())), switchMap(seedForms => from(this.db.resetData(seedForms)).pipe(map(() => FormsActions.resetDataSuccess()), tap(() => location.reload()))), catchError(error => of(FormsActions.loadFormsFailure({\n        error: error.message\n      })))))));\n    }\n    static {\n      this.ɵfac = function FormsEffects_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || FormsEffects)(i0.ɵɵinject(i1.Actions), i0.ɵɵinject(i2.IndexedDBService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: FormsEffects,\n        factory: FormsEffects.ɵfac\n      });\n    }\n  }\n  return FormsEffects;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}