{"ast":null,"code":"import _asyncToGenerator from \"D:/form-builder-angular19-updated/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Store } from '@ngrx/store';\nimport { loadForms } from '../state/forms/forms.actions';\nimport { IndexedDbService } from '../core/services/indexeddb.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"../core/services/indexeddb.service\";\nfunction BuilderComponent_div_21_div_7_div_10_label_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Options (comma) \");\n    i0.ɵɵelementStart(2, \"input\", 18);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function BuilderComponent_div_21_div_7_div_10_label_4_Template_input_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const el_r5 = i0.ɵɵnextContext(2).$implicit;\n      i0.ɵɵtwoWayBindingSet(el_r5.optionsString, $event) || (el_r5.optionsString = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"blur\", function BuilderComponent_div_21_div_7_div_10_label_4_Template_input_blur_2_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const el_r5 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.syncOptions(el_r5));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const el_r5 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", el_r5.optionsString);\n  }\n}\nfunction BuilderComponent_div_21_div_7_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"label\");\n    i0.ɵɵtext(2, \"Label \");\n    i0.ɵɵelementStart(3, \"input\", 15);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function BuilderComponent_div_21_div_7_div_10_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const el_r5 = i0.ɵɵnextContext().$implicit;\n      i0.ɵɵtwoWayBindingSet(el_r5.label, $event) || (el_r5.label = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, BuilderComponent_div_21_div_7_div_10_label_4_Template, 3, 1, \"label\", 16);\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6, \"Placeholder \");\n    i0.ɵɵelementStart(7, \"input\", 15);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function BuilderComponent_div_21_div_7_div_10_Template_input_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const el_r5 = i0.ɵɵnextContext().$implicit;\n      i0.ɵɵtwoWayBindingSet(el_r5.placeholder, $event) || (el_r5.placeholder = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"label\")(9, \"input\", 17);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function BuilderComponent_div_21_div_7_div_10_Template_input_ngModelChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const el_r5 = i0.ɵɵnextContext().$implicit;\n      i0.ɵɵtwoWayBindingSet(el_r5.required, $event) || (el_r5.required = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \" Required\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const el_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", el_r5.label);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r5.type === \"select\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", el_r5.placeholder);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", el_r5.required);\n  }\n}\nfunction BuilderComponent_div_21_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"strong\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"small\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 12)(6, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function BuilderComponent_div_21_div_7_Template_button_click_6_listener() {\n      const el_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.selectElement(el_r5));\n    });\n    i0.ɵɵtext(7, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function BuilderComponent_div_21_div_7_Template_button_click_8_listener() {\n      const i_r6 = i0.ɵɵrestoreView(_r4).index;\n      const pi_r2 = i0.ɵɵnextContext().index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.removeField(pi_r2, i_r6));\n    });\n    i0.ɵɵtext(9, \"Remove\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(10, BuilderComponent_div_21_div_7_div_10_Template, 11, 4, \"div\", 13);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(el_r5.label || el_r5.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", el_r5.type, \")\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selectedElement === el_r5);\n  }\n}\nfunction BuilderComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8)(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function BuilderComponent_div_21_Template_button_click_4_listener() {\n      const pi_r2 = i0.ɵɵrestoreView(_r1).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.removePage(pi_r2));\n    });\n    i0.ɵɵtext(5, \"Delete\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 9);\n    i0.ɵɵtemplate(7, BuilderComponent_div_21_div_7_Template, 11, 3, \"div\", 10);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r9 = ctx.$implicit;\n    const pi_r2 = ctx.index;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(page_r9.title || \"Page \" + (pi_r2 + 1));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", page_r9.elements);\n  }\n}\nexport let BuilderComponent = /*#__PURE__*/(() => {\n  class BuilderComponent {\n    constructor(store, db) {\n      this.store = store;\n      this.db = db;\n      this.schema = {\n        title: 'New Form',\n        pages: [{\n          id: 'page-1',\n          title: 'Page 1',\n          elements: []\n        }],\n        rules: [],\n        computed: []\n      };\n    }\n    addField(type) {\n      const id = 'f' + Date.now();\n      const el = {\n        id,\n        type,\n        label: type === 'text' ? 'Text field' : type + ' field'\n      };\n      if (type === 'select') {\n        el.options = ['Option 1', 'Option 2'];\n        el.optionsText = el.options.join(',');\n      }\n      this.schema.pages[0].elements.push(el);\n    }\n    updateOptions(el) {\n      el.options = (el.optionsText || '').split(',').map(s => s.trim()).filter(Boolean);\n    }\n    remove(i) {\n      this.schema.pages[0].elements.splice(i, 1);\n    }\n    save() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const form = {\n          id: 'form-' + Date.now(),\n          name: _this.schema.title || 'Untitled',\n          version: '1.0.0',\n          schema: _this.schema,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString()\n        };\n        yield _this.db.saveForm(form);\n        // alert('Saved form to IndexedDB. ID: ' + form.id);\n        _this.store.dispatch(loadForms());\n      })();\n    }\n    addPage() {\n      const id = 'page-' + (this.schema.pages.length + 1);\n      this.schema.pages.push({\n        id,\n        title: 'Page ' + (this.schema.pages.length + 1),\n        elements: []\n      });\n    }\n    static {\n      this.ɵfac = function BuilderComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || BuilderComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.IndexedDbService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: BuilderComponent,\n        selectors: [[\"app-builder\"]],\n        decls: 22,\n        vars: 2,\n        consts: [[1, \"builder-wrap\"], [\"aria-label\", \"Field palette\", 1, \"palette\"], [1, \"palette-item\", 3, \"click\"], [3, \"click\"], [\"aria-label\", \"Form canvas\", 1, \"canvas\"], [1, \"pages\"], [\"class\", \"page\", 4, \"ngFor\", \"ngForOf\"], [1, \"page\"], [1, \"page-header\"], [1, \"elements\"], [\"class\", \"element\", 4, \"ngFor\", \"ngForOf\"], [1, \"element\"], [1, \"element-actions\"], [\"class\", \"editor\", 4, \"ngIf\"], [1, \"editor\"], [3, \"ngModelChange\", \"ngModel\"], [4, \"ngIf\"], [\"type\", \"checkbox\", 3, \"ngModelChange\", \"ngModel\"], [3, \"ngModelChange\", \"blur\", \"ngModel\"]],\n        template: function BuilderComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"aside\", 1)(2, \"h3\");\n            i0.ɵɵtext(3, \"Palette\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_div_click_4_listener() {\n              return ctx.addField(\"text\");\n            });\n            i0.ɵɵtext(5, \"Text Field\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"div\", 2);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_div_click_6_listener() {\n              return ctx.addField(\"number\");\n            });\n            i0.ɵɵtext(7, \"Number Field\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\", 2);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_div_click_8_listener() {\n              return ctx.addField(\"date\");\n            });\n            i0.ɵɵtext(9, \"Date Field\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"div\", 2);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_div_click_10_listener() {\n              return ctx.addField(\"select\");\n            });\n            i0.ɵɵtext(11, \"Select\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"div\", 2);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_div_click_12_listener() {\n              return ctx.addPage();\n            });\n            i0.ɵɵtext(13, \"+ Add Page\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(14, \"hr\");\n            i0.ɵɵelementStart(15, \"button\", 3);\n            i0.ɵɵlistener(\"click\", function BuilderComponent_Template_button_click_15_listener() {\n              return ctx.save();\n            });\n            i0.ɵɵtext(16, \"Save\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(17, \"main\", 4)(18, \"h2\");\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"div\", 5);\n            i0.ɵɵtemplate(21, BuilderComponent_div_21_Template, 8, 2, \"div\", 6);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(19);\n            i0.ɵɵtextInterpolate(ctx.schema.title || \"Untitled\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.schema.pages);\n          }\n        },\n        styles: [\"[_ngcontent-%COMP%]:root{--bg:#2b0f3b;--card:#1f1b2b;--muted:#cfc7d6}.builder-wrap[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;color:#fff;font-family:Inter,Roboto,Arial,sans-serif}.palette[_ngcontent-%COMP%]{width:250px;background:linear-gradient(180deg,#3b234f,#2a1536);padding:12px;border-radius:8px}.palette[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0}.palette-item[_ngcontent-%COMP%]{padding:8px;margin:6px 0;background:#ffffff08;border-radius:6px;cursor:pointer}.canvas[_ngcontent-%COMP%]{flex:1;background:#00000059;padding:12px;border-radius:8px}.page[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.04);padding:10px;margin-bottom:10px;border-radius:6px}.element[_ngcontent-%COMP%]{padding:8px;background:#ffffff05;margin:6px 0;border-radius:6px;display:flex;justify-content:space-between;align-items:center}.element[_ngcontent-%COMP%]   .editor[_ngcontent-%COMP%]{margin-top:8px;display:flex;gap:8px;flex-direction:column}.element-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:6px}\"],\n        changeDetection: 0\n      });\n    }\n  }\n  return BuilderComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}