{"ast":null,"code":"import _asyncToGenerator from \"D:/form-builder-angular19-updated/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute } from '@angular/router';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { WorkerService } from '../core/services/worker.service';\nimport { IndexedDBService } from '../core/services/indexeddb.service';\nimport { Subject, takeUntil } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../core/services/indexeddb.service\";\nimport * as i3 from \"../core/services/worker.service\";\nfunction RuntimeComponent_div_9_div_1_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 17);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 18);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const page_r2 = ctx.$implicit;\n    const i_r3 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassProp(\"active\", ctx_r3.currentPageIndex === i_r3)(\"completed\", i_r3 < ctx_r3.currentPageIndex);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r3 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(page_r2.title);\n  }\n}\nfunction RuntimeComponent_div_9_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"div\", 12);\n    i0.ɵɵtemplate(2, RuntimeComponent_div_9_div_1_div_2_Template, 5, 6, \"div\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14);\n    i0.ɵɵelement(4, \"div\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.formSchema.schema.pages);\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleProp(\"width\", (ctx_r3.currentPageIndex + 1) / ctx_r3.formSchema.schema.pages.length * 100, \"%\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r6 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Minimum length is \", el_r6.validators == null ? null : el_r6.validators.minLength, \"\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r6 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Maximum length is \", el_r6.validators == null ? null : el_r6.validators.maxLength, \"\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Invalid format\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_1_Template, 2, 0, \"span\", 36)(2, RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_2_Template, 2, 1, \"span\", 36)(3, RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_3_Template, 2, 1, \"span\", 36)(4, RuntimeComponent_div_9_div_3_div_4_div_1_div_5_span_4_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_8_0;\n    let tmp_9_0;\n    let tmp_10_0;\n    let tmp_11_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"id\", el_r6.id + \"-error\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_8_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_8_0.errors == null ? null : tmp_8_0.errors[\"required\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_9_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_9_0.errors == null ? null : tmp_9_0.errors[\"minlength\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_10_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_10_0.errors == null ? null : tmp_10_0.errors[\"maxlength\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_11_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_11_0.errors == null ? null : tmp_11_0.errors[\"pattern\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_1_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 32);\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_1_div_5_Template, 5, 5, \"div\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_15_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id)(\"placeholder\", el_r6.placeholder || \"\");\n    i0.ɵɵattribute(\"aria-label\", el_r6.label)(\"aria-required\", el_r6.required)(\"aria-describedby\", el_r6.id + \"-error\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_15_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_15_0.invalid) && (((tmp_15_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_15_0.dirty) || ((tmp_15_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_15_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_2_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_2_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_2_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_2_div_5_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_2_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"textarea\", 37);\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_2_div_5_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_14_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id)(\"placeholder\", el_r6.placeholder || \"\");\n    i0.ɵɵattribute(\"aria-label\", el_r6.label)(\"aria-required\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.invalid) && (((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.dirty) || ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r6 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Minimum value is \", el_r6.validators == null ? null : el_r6.validators.min, \"\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r6 = i0.ɵɵnextContext(3).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Maximum value is \", el_r6.validators == null ? null : el_r6.validators.max, \"\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_1_Template, 2, 0, \"span\", 36)(2, RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_2_Template, 2, 1, \"span\", 36)(3, RuntimeComponent_div_9_div_3_div_4_div_3_div_5_span_3_Template, 2, 1, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    let tmp_8_0;\n    let tmp_9_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_8_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_8_0.errors == null ? null : tmp_8_0.errors[\"min\"]);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_9_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_9_0.errors == null ? null : tmp_9_0.errors[\"max\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_3_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 40);\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_3_div_5_Template, 4, 3, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_14_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id)(\"placeholder\", el_r6.placeholder || \"\");\n    i0.ɵɵattribute(\"aria-label\", el_r6.label)(\"aria-required\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.invalid) && (((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.dirty) || ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_4_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_4_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_4_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_4_div_5_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_4_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 41);\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_4_div_5_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_13_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id);\n    i0.ɵɵattribute(\"aria-label\", el_r6.label)(\"aria-required\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_13_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_13_0.invalid) && (((tmp_13_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_13_0.dirty) || ((tmp_13_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_13_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_5_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_5_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 45);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const opt_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", opt_r7);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(opt_r7);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_5_div_8_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_5_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_5_div_8_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_5_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"select\", 42)(5, \"option\", 43);\n    i0.ɵɵtext(6, \"-- Select --\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, RuntimeComponent_div_9_div_3_div_4_div_5_option_7_Template, 2, 2, \"option\", 44);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, RuntimeComponent_div_9_div_3_div_4_div_5_div_8_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_14_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id);\n    i0.ɵɵattribute(\"aria-label\", el_r6.label)(\"aria-required\", el_r6.required);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", el_r6.options);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.invalid) && (((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.dirty) || ((tmp_14_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_14_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_6_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_6_label_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 49);\n    i0.ɵɵelement(1, \"input\", 50);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const opt_r8 = ctx.$implicit;\n    const i_r9 = ctx.index;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id + \"-\" + i_r9)(\"formControlName\", el_r6.id)(\"value\", opt_r8);\n    i0.ɵɵattribute(\"aria-label\", opt_r8);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(opt_r8);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_6_div_7_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_6_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_6_div_7_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"fieldset\")(2, \"legend\", 46);\n    i0.ɵɵtext(3);\n    i0.ɵɵtemplate(4, RuntimeComponent_div_9_div_3_div_4_div_6_span_4_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 47);\n    i0.ɵɵtemplate(6, RuntimeComponent_div_9_div_3_div_4_div_6_label_6_Template, 4, 5, \"label\", 48);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(7, RuntimeComponent_div_9_div_3_div_4_div_6_div_7_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_9_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", el_r6.options);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_9_0.invalid) && (((tmp_9_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_9_0.dirty) || ((tmp_9_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_9_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_7_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_7_div_6_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_7_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_7_div_6_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 51);\n    i0.ɵɵelement(2, \"input\", 52);\n    i0.ɵɵelementStart(3, \"span\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_7_span_5_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, RuntimeComponent_div_9_div_3_div_4_div_7_div_6_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_12_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id)(\"formControlName\", el_r6.id);\n    i0.ɵɵattribute(\"aria-label\", el_r6.label);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(el_r6.label);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_12_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_12_0.invalid) && (((tmp_12_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_12_0.dirty) || ((tmp_12_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_12_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_8_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1, \"*\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_8_div_5_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"This field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_8_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 39);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_8_div_5_span_1_Template, 2, 0, \"span\", 36);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_7_0;\n    const el_r6 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (tmp_7_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_7_0.errors == null ? null : tmp_7_0.errors[\"required\"]);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30);\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_div_4_div_8_span_3_Template, 2, 0, \"span\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 53);\n    i0.ɵɵlistener(\"change\", function RuntimeComponent_div_9_div_3_div_4_div_8_Template_input_change_4_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const el_r6 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r3.onFileChange($event, el_r6.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, RuntimeComponent_div_9_div_3_div_4_div_8_div_5_Template, 2, 1, \"div\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    let tmp_11_0;\n    const el_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"for\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", el_r6.label, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.required);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"id\", el_r6.id);\n    i0.ɵɵattribute(\"aria-label\", el_r6.label);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ((tmp_11_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_11_0.invalid) && (((tmp_11_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_11_0.dirty) || ((tmp_11_0 = ctx_r3.fg.get(el_r6.id)) == null ? null : tmp_11_0.touched)));\n  }\n}\nfunction RuntimeComponent_div_9_div_3_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_3_div_4_div_1_Template, 6, 10, \"div\", 28)(2, RuntimeComponent_div_9_div_3_div_4_div_2_Template, 6, 9, \"div\", 28)(3, RuntimeComponent_div_9_div_3_div_4_div_3_Template, 6, 9, \"div\", 28)(4, RuntimeComponent_div_9_div_3_div_4_div_4_Template, 6, 8, \"div\", 28)(5, RuntimeComponent_div_9_div_3_div_4_div_5_Template, 9, 9, \"div\", 28)(6, RuntimeComponent_div_9_div_3_div_4_div_6_Template, 8, 4, \"div\", 28)(7, RuntimeComponent_div_9_div_3_div_4_div_7_Template, 7, 7, \"div\", 28)(8, RuntimeComponent_div_9_div_3_div_4_div_8_Template, 6, 6, \"div\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const el_r6 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵclassProp(\"hidden\", ctx_r3.hiddenFields[el_r6.id]);\n    i0.ɵɵattribute(\"data-field-id\", el_r6.id);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"text\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"textarea\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"number\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"date\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"select\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"radio\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"checkbox\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", el_r6.type === \"file\");\n  }\n}\nfunction RuntimeComponent_div_9_div_3_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 54);\n    i0.ɵɵlistener(\"click\", function RuntimeComponent_div_9_div_3_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r3 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r3.nextPage());\n    });\n    i0.ɵɵtext(1, \" Next \\u2192 \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RuntimeComponent_div_9_div_3_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 55);\n    i0.ɵɵtext(1, \" Submit Form \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.fg.invalid);\n  }\n}\nfunction RuntimeComponent_div_9_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"h3\", 20);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 21);\n    i0.ɵɵtemplate(4, RuntimeComponent_div_9_div_3_div_4_Template, 9, 11, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 23)(6, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function RuntimeComponent_div_9_div_3_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.previousPage());\n    });\n    i0.ɵɵtext(7, \" \\u2190 Previous \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, RuntimeComponent_div_9_div_3_button_8_Template, 2, 0, \"button\", 25)(9, RuntimeComponent_div_9_div_3_button_9_Template, 2, 1, \"button\", 26);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const currentPage_r12 = ctx.ngIf;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(currentPage_r12.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", currentPage_r12.elements);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.currentPageIndex === 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentPageIndex < ctx_r3.formSchema.schema.pages.length - 1);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentPageIndex === ctx_r3.formSchema.schema.pages.length - 1);\n  }\n}\nfunction RuntimeComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtemplate(1, RuntimeComponent_div_9_div_1_Template, 5, 3, \"div\", 8);\n    i0.ɵɵelementStart(2, \"form\", 9);\n    i0.ɵɵlistener(\"ngSubmit\", function RuntimeComponent_div_9_Template_form_ngSubmit_2_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.submit());\n    });\n    i0.ɵɵtemplate(3, RuntimeComponent_div_9_div_3_Template, 10, 5, \"div\", 10);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.formSchema.schema.pages.length > 1);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.fg);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.formSchema.schema.pages[ctx_r3.currentPageIndex]);\n  }\n}\nfunction RuntimeComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 56)(1, \"p\");\n    i0.ɵɵtext(2, \"Loading form...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let RuntimeComponent = /*#__PURE__*/(() => {\n  class RuntimeComponent {\n    constructor(route, db, worker) {\n      this.route = route;\n      this.db = db;\n      this.worker = worker;\n      this.fg = new FormGroup({});\n      this.currentPageIndex = 0;\n      this.hiddenFields = {};\n      this.destroy$ = new Subject();\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const id = _this.route.snapshot.paramMap.get('id') || 'form-1';\n        yield _this.loadForm(id);\n      })();\n    }\n    ngOnDestroy() {\n      this.destroy$.next();\n      this.destroy$.complete();\n    }\n    loadForm(id) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const forms = yield _this2.db.getAllForms();\n        _this2.formSchema = forms.find(f => f.id === id);\n        if (!_this2.formSchema && forms.length > 0) {\n          _this2.formSchema = forms[0];\n        }\n        if (_this2.formSchema) {\n          _this2.buildForm();\n          _this2.setupRulesAndComputed();\n        }\n      })();\n    }\n    buildForm() {\n      const controls = {};\n      // Build controls for all pages\n      this.formSchema.schema.pages.forEach(page => {\n        page.elements.forEach(el => {\n          const validators = this.getValidators(el);\n          const defaultValue = this.getDefaultValue(el);\n          controls[el.id] = new FormControl({\n            value: defaultValue,\n            disabled: el.disabled\n          }, validators);\n        });\n      });\n      this.fg = new FormGroup(controls);\n    }\n    getValidators(element) {\n      const validators = [];\n      if (element.required) {\n        validators.push(Validators.required);\n      }\n      if (element.validators) {\n        if (element.validators.minLength) {\n          validators.push(Validators.minLength(element.validators.minLength));\n        }\n        if (element.validators.maxLength) {\n          validators.push(Validators.maxLength(element.validators.maxLength));\n        }\n        if (element.validators.min !== undefined) {\n          validators.push(Validators.min(element.validators.min));\n        }\n        if (element.validators.max !== undefined) {\n          validators.push(Validators.max(element.validators.max));\n        }\n        if (element.validators.pattern) {\n          validators.push(Validators.pattern(element.validators.pattern));\n        }\n      }\n      return validators;\n    }\n    getDefaultValue(element) {\n      if (element.type === 'checkbox') {\n        return false;\n      }\n      if (element.type === 'number') {\n        return null;\n      }\n      return element.default || '';\n    }\n    setupRulesAndComputed() {\n      this.fg.valueChanges.pipe(takeUntil(this.destroy$)).subscribe(values => {\n        this.evaluateRules(values);\n        this.evaluateComputed(values);\n      });\n      // Initial evaluation\n      this.evaluateRules(this.fg.value);\n      this.evaluateComputed(this.fg.value);\n    }\n    evaluateRules(values) {\n      if (!this.formSchema.schema.rules || this.formSchema.schema.rules.length === 0) {\n        return;\n      }\n      this.formSchema.schema.rules.forEach(rule => {\n        try {\n          // Evaluate condition\n          let condition = rule.if;\n          // Replace field references with actual values\n          Object.keys(values).forEach(key => {\n            const value = values[key];\n            const regex = new RegExp(`\\\\b${key}\\\\b`, 'g');\n            const replacement = typeof value === 'string' ? `'${value}'` : String(value);\n            condition = condition.replace(regex, replacement);\n          });\n          // Evaluate the condition\n          const result = this.safeEvaluate(condition);\n          // Apply actions\n          if (rule.then && Array.isArray(rule.then)) {\n            rule.then.forEach(action => {\n              this.applyAction(action, result);\n            });\n          }\n        } catch (error) {\n          console.error('Error evaluating rule:', rule, error);\n        }\n      });\n    }\n    safeEvaluate(expression) {\n      try {\n        return Boolean(Function(`'use strict'; return (${expression})`)());\n      } catch {\n        return false;\n      }\n    }\n    applyAction(action, conditionResult) {\n      const control = this.fg.get(action.target);\n      if (!control) return;\n      switch (action.action) {\n        case 'show':\n          this.hiddenFields[action.target] = !conditionResult;\n          break;\n        case 'hide':\n          this.hiddenFields[action.target] = conditionResult;\n          break;\n        case 'enable':\n          if (conditionResult) {\n            control.enable();\n          }\n          break;\n        case 'disable':\n          if (conditionResult) {\n            control.disable();\n          }\n          break;\n        case 'setValue':\n          if (conditionResult && action.value !== undefined) {\n            control.setValue(action.value, {\n              emitEvent: false\n            });\n          }\n          break;\n      }\n    }\n    evaluateComputed(values) {\n      if (!this.formSchema.schema.computed || this.formSchema.schema.computed.length === 0) {\n        return;\n      }\n      this.formSchema.schema.computed.forEach(computed => {\n        try {\n          let expression = computed.expr;\n          // Replace field references with actual values\n          Object.keys(values).forEach(key => {\n            const value = values[key] || 0;\n            const regex = new RegExp(`\\\\b${key}\\\\b`, 'g');\n            expression = expression.replace(regex, String(value));\n          });\n          // Evaluate the expression\n          const result = this.safeEvaluateExpression(expression);\n          // Set the computed value\n          const control = this.fg.get(computed.target);\n          if (control) {\n            control.setValue(result, {\n              emitEvent: false\n            });\n          }\n        } catch (error) {\n          console.error('Error evaluating computed field:', computed, error);\n        }\n      });\n    }\n    safeEvaluateExpression(expression) {\n      try {\n        return Function(`'use strict'; return (${expression})`)();\n      } catch {\n        return null;\n      }\n    }\n    nextPage() {\n      if (this.currentPageIndex < this.formSchema.schema.pages.length - 1) {\n        this.currentPageIndex++;\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth'\n        });\n      }\n    }\n    previousPage() {\n      if (this.currentPageIndex > 0) {\n        this.currentPageIndex--;\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth'\n        });\n      }\n    }\n    saveDraft() {\n      localStorage.setItem(`form-draft-${this.formSchema.id}`, JSON.stringify({\n        values: this.fg.value,\n        pageIndex: this.currentPageIndex,\n        savedAt: new Date().toISOString()\n      }));\n      alert('Draft saved locally!');\n    }\n    loadDraft() {\n      const draftKey = `form-draft-${this.formSchema.id}`;\n      const draft = localStorage.getItem(draftKey);\n      if (draft) {\n        try {\n          const {\n            values,\n            pageIndex\n          } = JSON.parse(draft);\n          this.fg.patchValue(values);\n          this.currentPageIndex = pageIndex || 0;\n        } catch (error) {\n          console.error('Error loading draft:', error);\n        }\n      }\n    }\n    submit() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        if (_this3.fg.invalid) {\n          _this3.markAllAsTouched();\n          alert('Please fill in all required fields correctly.');\n          return;\n        }\n        const submission = {\n          id: 's-' + Date.now(),\n          formId: _this3.formSchema.id,\n          formVersion: _this3.formSchema.version,\n          data: _this3.fg.value,\n          createdAt: new Date().toISOString()\n        };\n        try {\n          yield _this3.db.saveSubmission(submission);\n          // Clear draft\n          localStorage.removeItem(`form-draft-${_this3.formSchema.id}`);\n          alert('Form submitted successfully! Submission ID: ' + submission.id);\n          // Reset form\n          _this3.fg.reset();\n          _this3.currentPageIndex = 0;\n        } catch (error) {\n          console.error('Error submitting form:', error);\n          alert('Error submitting form. Please try again.');\n        }\n      })();\n    }\n    markAllAsTouched() {\n      Object.keys(this.fg.controls).forEach(key => {\n        this.fg.get(key)?.markAsTouched();\n      });\n    }\n    onFileChange(event, fieldId) {\n      const file = event.target.files[0];\n      if (file) {\n        // For this demo, store file name only\n        // In production, you'd handle file upload properly\n        const control = this.fg.get(fieldId);\n        if (control) {\n          control.setValue(file.name);\n        }\n      }\n    }\n    static {\n      this.ɵfac = function RuntimeComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || RuntimeComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.IndexedDBService), i0.ɵɵdirectiveInject(i3.WorkerService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: RuntimeComponent,\n        selectors: [[\"app-runtime\"]],\n        decls: 11,\n        vars: 4,\n        consts: [[1, \"runtime-container\"], [1, \"runtime-header\"], [1, \"header-actions\"], [\"routerLink\", \"/builder\", 1, \"btn\", \"btn-secondary\"], [1, \"btn\", \"btn-info\", 3, \"click\", \"disabled\"], [\"class\", \"runtime-content\", 4, \"ngIf\"], [\"class\", \"no-form\", 4, \"ngIf\"], [1, \"runtime-content\"], [\"class\", \"progress-indicator\", 4, \"ngIf\"], [1, \"runtime-form\", 3, \"ngSubmit\", \"formGroup\"], [\"class\", \"form-page\", 4, \"ngIf\"], [1, \"progress-indicator\"], [1, \"progress-steps\"], [\"class\", \"progress-step\", 3, \"active\", \"completed\", 4, \"ngFor\", \"ngForOf\"], [1, \"progress-bar\"], [1, \"progress-fill\"], [1, \"progress-step\"], [1, \"step-circle\"], [1, \"step-label\"], [1, \"form-page\"], [1, \"page-title\"], [1, \"form-fields\"], [\"class\", \"form-field\", 3, \"hidden\", 4, \"ngFor\", \"ngForOf\"], [1, \"form-navigation\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\", \"disabled\"], [\"type\", \"button\", \"class\", \"btn btn-primary\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"submit\", \"class\", \"btn btn-success\", 3, \"disabled\", 4, \"ngIf\"], [1, \"form-field\"], [\"class\", \"field-wrapper\", 4, \"ngIf\"], [1, \"field-wrapper\"], [1, \"field-label\", 3, \"for\"], [\"class\", \"required\", 4, \"ngIf\"], [\"type\", \"text\", 1, \"form-control\", 3, \"id\", \"formControlName\", \"placeholder\"], [\"class\", \"error-message\", \"role\", \"alert\", 3, \"id\", 4, \"ngIf\"], [1, \"required\"], [\"role\", \"alert\", 1, \"error-message\", 3, \"id\"], [4, \"ngIf\"], [\"rows\", \"4\", 1, \"form-control\", 3, \"id\", \"formControlName\", \"placeholder\"], [\"class\", \"error-message\", \"role\", \"alert\", 4, \"ngIf\"], [\"role\", \"alert\", 1, \"error-message\"], [\"type\", \"number\", 1, \"form-control\", 3, \"id\", \"formControlName\", \"placeholder\"], [\"type\", \"date\", 1, \"form-control\", 3, \"id\", \"formControlName\"], [1, \"form-control\", 3, \"id\", \"formControlName\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [1, \"field-label\"], [1, \"radio-group\"], [\"class\", \"radio-label\", 4, \"ngFor\", \"ngForOf\"], [1, \"radio-label\"], [\"type\", \"radio\", 3, \"id\", \"formControlName\", \"value\"], [1, \"checkbox-label\", 3, \"for\"], [\"type\", \"checkbox\", 3, \"id\", \"formControlName\"], [\"type\", \"file\", 1, \"form-control\", 3, \"change\", \"id\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [1, \"no-form\"]],\n        template: function RuntimeComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵtext(3);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2)(5, \"button\", 3);\n            i0.ɵɵtext(6, \"Back to Builder\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function RuntimeComponent_Template_button_click_7_listener() {\n              return ctx.saveDraft();\n            });\n            i0.ɵɵtext(8, \"Save Draft\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(9, RuntimeComponent_div_9_Template, 4, 3, \"div\", 5)(10, RuntimeComponent_div_10_Template, 3, 0, \"div\", 6);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate((ctx.formSchema == null ? null : ctx.formSchema.name) || \"Form\");\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"disabled\", !ctx.fg);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.formSchema);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.formSchema);\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return RuntimeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}