{"ast":null,"code":"import _asyncToGenerator from \"D:/form-builder-angular19-updated/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute } from '@angular/router';\nimport { IndexedDBService } from '../core/services/indexeddb.service';\nimport { CommonModule } from '@angular/common';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../core/services/indexeddb.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/cdk/scrolling\";\nimport * as i5 from \"@angular/forms\";\nfunction SubmissionsComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"span\", 12);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 13);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 14)(8, \"pre\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"json\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const submission_r1 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(submission_r1.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(6, 3, submission_r1.createdAt, \"medium\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(10, 6, submission_r1.data));\n  }\n}\nexport let SubmissionsComponent = /*#__PURE__*/(() => {\n  class SubmissionsComponent {\n    constructor(route, db) {\n      this.route = route;\n      this.db = db;\n      this.submissions = [];\n      this.filteredSubmissions = [];\n      this.formId = null;\n      this.searchTerm = '';\n      this.dateFilter = '';\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.formId = _this.route.snapshot.paramMap.get('id');\n        yield _this.loadSubmissions();\n      })();\n    }\n    loadSubmissions() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (_this2.formId) {\n          _this2.submissions = yield _this2.db.getSubmissions(_this2.formId);\n        } else {\n          _this2.submissions = yield _this2.db.getAllSubmissions();\n        }\n        _this2.applyFilters();\n      })();\n    }\n    applyFilters() {\n      this.filteredSubmissions = this.submissions.filter(sub => {\n        const matchesSearch = !this.searchTerm || JSON.stringify(sub.data).toLowerCase().includes(this.searchTerm.toLowerCase());\n        const matchesDate = !this.dateFilter || new Date(sub.createdAt).toDateString() === new Date(this.dateFilter).toDateString();\n        return matchesSearch && matchesDate;\n      });\n    }\n    onSearchChange() {\n      this.applyFilters();\n    }\n    onDateChange() {\n      this.applyFilters();\n    }\n    exportToCSV() {\n      if (this.filteredSubmissions.length === 0) return;\n      const headers = ['ID', 'Form ID', 'Created At', 'Data'];\n      const csvContent = [headers.join(','), ...this.filteredSubmissions.map(sub => [sub.id, sub.formId, sub.createdAt, `\"${JSON.stringify(sub.data).replace(/\"/g, '\"\"')}\"`].join(','))].join('\\n');\n      const blob = new Blob([csvContent], {\n        type: 'text/csv'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `submissions-${this.formId || 'all'}-${new Date().toISOString().split('T')[0]}.csv`;\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n    trackBySubmission(index, submission) {\n      return submission.id;\n    }\n    static {\n      this.ɵfac = function SubmissionsComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || SubmissionsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.IndexedDBService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SubmissionsComponent,\n        selectors: [[\"app-submissions\"]],\n        decls: 15,\n        vars: 7,\n        consts: [[1, \"submissions-container\"], [1, \"submissions-header\"], [1, \"header-actions\"], [\"type\", \"text\", \"placeholder\", \"Search submissions...\", 1, \"form-control\", \"search-input\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"date\", 1, \"form-control\", \"date-input\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [1, \"btn\", \"btn-primary\", 3, \"click\", \"disabled\"], [1, \"submissions-stats\"], [1, \"submissions-list\"], [\"itemSize\", \"100\", 1, \"viewport\"], [\"class\", \"submission-item\", 4, \"cdkVirtualFor\", \"cdkVirtualForOf\", \"cdkVirtualForTrackBy\"], [1, \"submission-item\"], [1, \"submission-header\"], [1, \"submission-id\"], [1, \"submission-date\"], [1, \"submission-data\"]],\n        template: function SubmissionsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵtext(3, \"Form Submissions\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2)(5, \"input\", 3);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function SubmissionsComponent_Template_input_ngModelChange_5_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.searchTerm, $event) || (ctx.searchTerm = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function SubmissionsComponent_Template_input_input_5_listener() {\n              return ctx.onSearchChange();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"input\", 4);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function SubmissionsComponent_Template_input_ngModelChange_6_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.dateFilter, $event) || (ctx.dateFilter = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function SubmissionsComponent_Template_input_change_6_listener() {\n              return ctx.onDateChange();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function SubmissionsComponent_Template_button_click_7_listener() {\n              return ctx.exportToCSV();\n            });\n            i0.ɵɵtext(8, \" Export CSV \");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(9, \"div\", 6)(10, \"span\");\n            i0.ɵɵtext(11);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(12, \"div\", 7)(13, \"cdk-virtual-scroll-viewport\", 8);\n            i0.ɵɵtemplate(14, SubmissionsComponent_div_14_Template, 11, 8, \"div\", 9);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(5);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.searchTerm);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.dateFilter);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"disabled\", ctx.filteredSubmissions.length === 0);\n            i0.ɵɵadvance(4);\n            i0.ɵɵtextInterpolate2(\"Showing \", ctx.filteredSubmissions.length, \" of \", ctx.submissions.length, \" submissions\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"cdkVirtualForOf\", ctx.filteredSubmissions)(\"cdkVirtualForTrackBy\", ctx.trackBySubmission);\n          }\n        },\n        dependencies: [CommonModule, i3.JsonPipe, i3.DatePipe, ScrollingModule, i4.CdkFixedSizeVirtualScroll, i4.CdkVirtualForOf, i4.CdkVirtualScrollViewport, FormsModule, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n        styles: [\".submissions-container[_ngcontent-%COMP%]{padding:16px;height:100vh;display:flex;flex-direction:column}.submissions-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.search-input[_ngcontent-%COMP%]{width:200px}.date-input[_ngcontent-%COMP%]{width:150px}.submissions-stats[_ngcontent-%COMP%]{margin-bottom:12px;color:var(--muted);font-size:.9rem}.submissions-list[_ngcontent-%COMP%]{flex:1;border:1px solid var(--border);border-radius:8px;overflow:hidden}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.submission-item[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid var(--border);background:var(--bg)}.submission-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.submission-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.submission-id[_ngcontent-%COMP%]{font-weight:600;color:var(--primary)}.submission-date[_ngcontent-%COMP%]{color:var(--muted);font-size:.9rem}.submission-data[_ngcontent-%COMP%]{background:var(--bg);border:1px solid var(--border);border-radius:4px;padding:8px;max-height:200px;overflow-y:auto}.submission-data[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:var(--fg);white-space:pre-wrap;word-break:break-word}@media (max-width: 768px){.submissions-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.header-actions[_ngcontent-%COMP%]{flex-direction:column}.search-input[_ngcontent-%COMP%], .date-input[_ngcontent-%COMP%]{width:100%}}\"],\n        changeDetection: 0\n      });\n    }\n  }\n  return SubmissionsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}