"use strict";(self.webpackChunkform_builder_offline=self.webpackChunkform_builder_offline||[]).push([[291],{1291:(y,u,r)=>{r.r(u),r.d(u,{SubmissionsModule:()=>S});var m=r(2881),h=r(467),p=r(6866),d=r(7976),l=r(4341),t=r(1360),b=r(1705);function g(i,M){if(1&i&&(t.j41(0,"div",10)(1,"div",11)(2,"span",12),t.EFF(3),t.k0s(),t.j41(4,"span",13),t.EFF(5),t.nI1(6,"date"),t.k0s()(),t.j41(7,"div",14)(8,"pre"),t.EFF(9),t.nI1(10,"json"),t.k0s()()()),2&i){const s=M.$implicit;t.R7$(3),t.JRh(s.id),t.R7$(2),t.JRh(t.i5U(6,3,s.createdAt,"medium")),t.R7$(4),t.JRh(t.bMT(10,6,s.data))}}let f=(()=>{class i{constructor(s,e){this.route=s,this.db=e,this.submissions=[],this.filteredSubmissions=[],this.formId=null,this.searchTerm="",this.dateFilter=""}ngOnInit(){var s=this;return(0,h.A)(function*(){s.formId=s.route.snapshot.paramMap.get("id"),yield s.loadSubmissions()})()}loadSubmissions(){var s=this;return(0,h.A)(function*(){s.submissions=s.formId?yield s.db.getSubmissions(s.formId):yield s.db.getAllSubmissions(),s.applyFilters()})()}applyFilters(){this.filteredSubmissions=this.submissions.filter(s=>{const e=!this.searchTerm||JSON.stringify(s.data).toLowerCase().includes(this.searchTerm.toLowerCase()),n=!this.dateFilter||new Date(s.createdAt).toDateString()===new Date(this.dateFilter).toDateString();return e&&n})}onSearchChange(){this.applyFilters()}onDateChange(){this.applyFilters()}exportToCSV(){if(0===this.filteredSubmissions.length)return;const e=[["ID","Form ID","Created At","Data"].join(","),...this.filteredSubmissions.map(c=>[c.id,c.formId,c.createdAt,`"${JSON.stringify(c.data).replace(/"/g,'""')}"`].join(","))].join("\n"),n=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download=`submissions-${this.formId||"all"}-${(new Date).toISOString().split("T")[0]}.csv`,o.click(),URL.revokeObjectURL(a)}trackBySubmission(s,e){return e.id}static{this.\u0275fac=function(e){return new(e||i)(t.rXU(b.nX),t.rXU(p.n))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-submissions"]],decls:15,vars:7,consts:[[1,"submissions-container"],[1,"submissions-header"],[1,"header-actions"],["type","text","placeholder","Search submissions...",1,"form-control","search-input",3,"ngModelChange","input","ngModel"],["type","date",1,"form-control","date-input",3,"ngModelChange","change","ngModel"],[1,"btn","btn-primary",3,"click","disabled"],[1,"submissions-stats"],[1,"submissions-list"],["itemSize","100",1,"viewport"],["class","submission-item",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"submission-item"],[1,"submission-header"],[1,"submission-id"],[1,"submission-date"],[1,"submission-data"]],template:function(e,n){1&e&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3,"Form Submissions"),t.k0s(),t.j41(4,"div",2)(5,"input",3),t.mxI("ngModelChange",function(o){return t.DH7(n.searchTerm,o)||(n.searchTerm=o),o}),t.bIt("input",function(){return n.onSearchChange()}),t.k0s(),t.j41(6,"input",4),t.mxI("ngModelChange",function(o){return t.DH7(n.dateFilter,o)||(n.dateFilter=o),o}),t.bIt("change",function(){return n.onDateChange()}),t.k0s(),t.j41(7,"button",5),t.bIt("click",function(){return n.exportToCSV()}),t.EFF(8," Export CSV "),t.k0s()()(),t.j41(9,"div",6)(10,"span"),t.EFF(11),t.k0s()(),t.j41(12,"div",7)(13,"cdk-virtual-scroll-viewport",8),t.DNE(14,g,11,8,"div",9),t.k0s()()()),2&e&&(t.R7$(5),t.R50("ngModel",n.searchTerm),t.R7$(),t.R50("ngModel",n.dateFilter),t.R7$(),t.Y8G("disabled",0===n.filteredSubmissions.length),t.R7$(4),t.Lme("Showing ",n.filteredSubmissions.length," of ",n.submissions.length," submissions"),t.R7$(3),t.Y8G("cdkVirtualForOf",n.filteredSubmissions)("cdkVirtualForTrackBy",n.trackBySubmission))},dependencies:[m.MD,m.TG,m.vh,d.E9,d.yg,d.E$,d.d6,l.YN,l.me,l.BC,l.vS],styles:[".submissions-container[_ngcontent-%COMP%]{padding:16px;height:100vh;display:flex;flex-direction:column}.submissions-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.search-input[_ngcontent-%COMP%]{width:200px}.date-input[_ngcontent-%COMP%]{width:150px}.submissions-stats[_ngcontent-%COMP%]{margin-bottom:12px;color:var(--muted);font-size:.9rem}.submissions-list[_ngcontent-%COMP%]{flex:1;border:1px solid var(--border);border-radius:8px;overflow:hidden}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.submission-item[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid var(--border);background:var(--bg)}.submission-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.submission-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.submission-id[_ngcontent-%COMP%]{font-weight:600;color:var(--primary)}.submission-date[_ngcontent-%COMP%]{color:var(--muted);font-size:.9rem}.submission-data[_ngcontent-%COMP%]{background:var(--bg);border:1px solid var(--border);border-radius:4px;padding:8px;max-height:200px;overflow-y:auto}.submission-data[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:var(--fg);white-space:pre-wrap;word-break:break-word}@media (max-width: 768px){.submissions-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.header-actions[_ngcontent-%COMP%]{flex-direction:column}.search-input[_ngcontent-%COMP%], .date-input[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0})}}return i})();var C=r(5207);const v=[{path:"",component:f}];let S=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[m.MD,d.E9,C.iI.forChild(v)]})}}return i})()}}]);